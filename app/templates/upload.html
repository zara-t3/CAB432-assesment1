{% extends "template.html" %}
{% block content %}
  <h1 class="h4 mb-3">Upload</h1>
  <form id="uploadForm" enctype="multipart/form-data">
    <input type="file" name="file" class="form-control mb-2" />
    <button type="submit" class="btn btn-dark">Upload</button>
  </form>

  <hr>

  <div class="input-group mb-2" style="max-width:300px;">
    <input id="stockQuery" type="text" class="form-control" placeholder="e.g. mountains" />
    <button id="stockBtn" class="btn btn-outline-secondary">Import Stock Image</button>
  </div>

  <div id="uploadResult" class="text-muted mt-2"></div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById("uploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const token = getToken();
  if (!token) return location.href="/login";

  const form = e.target;
  const fd = new FormData(form);
  const res = await fetch(`${BASE}/images`, {
    method: "POST",
    headers: { Authorization: "Bearer " + token },
    body: fd
  });
  const j = await res.json();
  document.getElementById("uploadResult").textContent = JSON.stringify(j);
});


</script>
{% endblock %}
